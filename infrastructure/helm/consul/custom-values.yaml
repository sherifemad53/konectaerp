# Helm values for Consul
# Reference: https://github.com/hashicorp/consul-k8s/blob/main/charts/consul/values.yaml

global:
  name: consul
  datacenter: dc1
  image: "hashicorp/consul:1.18"

server:
  enabled: true
  replicas: 1
  bootstrapExpect: 1

  storage: 10Gi
  storageClass: standard-rwo

  resources:
    requests:
      memory: "512Mi"
      cpu: "500m"
    limits:
      memory: "1Gi"
      cpu: "500m"

  affinity: |
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchLabels:
              app: {{ template "consul.name" . }}
              release: "{{ .Release.Name }}"
              component: server
          topologyKey: kubernetes.io/hostname

client:
  enabled: true
  grpc: true

  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"

ui:
  enabled: true
  service:
    type: ClusterIP

connectInject:
  enabled: false # Disable service mesh, using only for service discovery

dns:
  enabled: true
  enableRedirection: false
